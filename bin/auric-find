#!/bin/zsh

main() {
    typeset opt filter=short-display
    typeset -a grepargs
    grepargs=( -i )
    while getopts :lwi opt; do
        case $opt in
            (l) filter=long-display ;;
            ([wi]) grepargs+=( $opt ) ;;
        esac
    done
    shift $(( OPTIND - 1 ))

    fgrep -h $grepargs "$@" ~/music/disc-*/metadata | $filter
}

short-display() {
    awk '{ print substr($0, 1, 8) }' | sort -u
}

long-display() {
    cat
}

main "$@"
